<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="My Profile - Smart Career Hub">
    <title th:text="${pageTitle} + ' - Smart Career Hub'">My Profile - Smart Career Hub</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

    <!-- Stylesheets -->
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <link rel="stylesheet" th:href="@{/css/dashboard.css}">
    <style>
        :root {
            --linkedin-blue: #0a66c2;
            --linkedin-blue-dark: #004182;
            --linkedin-gray-bg: #f8f9fa;
            --linkedin-border: #e0e0e0;
            --linkedin-text: #191919;
            --linkedin-text-secondary: #666666;
        }

        .profile-container {
            max-width: 1128px;
            margin: 0 auto;
            padding-top: 80px;
        }

        /* Profile Header */
        .profile-header {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-bottom: 16px;
            position: relative;
            overflow: hidden;
        }

        .cover-photo {
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            position: relative;
        }

        .cover-photo-edit {
            position: absolute;
            top: 16px;
            right: 16px;
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid var(--linkedin-border);
            border-radius: 4px;
            padding: 6px 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
            font-size: 14px;
            color: var(--linkedin-text);
            transition: all 0.2s;
        }

        .cover-photo-edit:hover {
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .profile-info {
            padding: 0 32px 32px;
            margin-top: -60px;
        }

        .profile-main {
            display: flex;
            align-items: flex-start;
            gap: 24px;
        }

        .profile-avatar-large {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            border: 5px solid white;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 64px;
            color: #666;
            position: relative;
            overflow: hidden;
            background-size: cover;
            background-position: center;
        }

        .avatar-edit-btn {
            position: absolute;
            bottom: 8px;
            right: 8px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--linkedin-blue);
            color: white;
            border: 3px solid white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }

        .avatar-edit-btn:hover {
            background: var(--linkedin-blue-dark);
        }

        .profile-details {
            flex: 1;
            padding-top: 40px;
        }

        .profile-name {
            font-size: 32px;
            font-weight: 700;
            color: var(--linkedin-text);
            margin: 0 0 4px;
        }

        .profile-title {
            font-size: 18px;
            color: var(--linkedin-text);
            margin: 0 0 8px;
            font-weight: 500;
        }

        .profile-location {
            color: var(--linkedin-text-secondary);
            margin: 0 0 16px;
            font-size: 14px;
        }

        .profile-stats {
            display: flex;
            gap: 24px;
            margin-top: 16px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--linkedin-text-secondary);
            font-size: 14px;
        }

        .stat-number {
            font-weight: 600;
            color: var(--linkedin-text);
        }

        .profile-actions {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        .btn-profile-primary {
            background: var(--linkedin-blue);
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 24px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: background 0.2s;
        }

        .btn-profile-primary:hover {
            background: var(--linkedin-blue-dark);
        }

        .btn-profile-secondary {
            background: transparent;
            color: var(--linkedin-blue);
            border: 1px solid var(--linkedin-blue);
            padding: 8px 20px;
            border-radius: 24px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .btn-profile-secondary:hover {
            background: rgba(10, 102, 194, 0.08);
        }

        .btn-profile-outline {
            background: transparent;
            color: var(--linkedin-text);
            border: 1px solid var(--linkedin-text);
            padding: 8px 20px;
            border-radius: 24px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s;
        }

        .btn-profile-outline:hover {
            background: rgba(25, 25, 25, 0.08);
        }

        /* Profile Sections */
        .profile-sections {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 16px;
        }

        .profile-section {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-bottom: 16px;
            position: relative;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--linkedin-text);
            margin: 0;
        }

        .edit-section-btn {
            background: transparent;
            border: none;
            color: var(--linkedin-blue);
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            padding: 6px 12px;
            border-radius: 4px;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .edit-section-btn:hover {
            background: rgba(10, 102, 194, 0.08);
        }

        /* About Section */
        .about-content {
            color: var(--linkedin-text);
            line-height: 1.6;
            font-size: 15px;
            white-space: pre-line;
        }

        .about-content.empty {
            color: var(--linkedin-text-secondary);
            font-style: italic;
        }

        /* Experience & Education */
        .experience-item,
        .education-item {
            padding: 16px 0;
            border-bottom: 1px solid var(--linkedin-border);
        }

        .experience-item:last-child,
        .education-item:last-child {
            border-bottom: none;
        }

        .exp-company,
        .edu-institution {
            font-weight: 600;
            color: var(--linkedin-text);
            margin-bottom: 4px;
        }

        .exp-position,
        .edu-degree {
            color: var(--linkedin-text-secondary);
            margin-bottom: 4px;
        }

        .exp-duration,
        .edu-duration {
            color: var(--linkedin-text-secondary);
            font-size: 13px;
        }

        .exp-description {
            margin-top: 8px;
            color: var(--linkedin-text);
            font-size: 14px;
            line-height: 1.5;
        }

        /* Skills */
        .skills-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .skill-tag {
            background: rgba(10, 102, 194, 0.1);
            color: var(--linkedin-blue);
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 14px;
            font-weight: 500;
        }

        /* Sidebar Widgets */
        .profile-widget {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            margin-bottom: 16px;
        }

        .widget-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--linkedin-text);
            margin-bottom: 16px;
        }

        .contact-info {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 12px;
            color: var(--linkedin-text);
            font-size: 14px;
        }

        .contact-item i {
            width: 20px;
            color: var(--linkedin-text-secondary);
        }

        .languages-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .language-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .language-name {
            color: var(--linkedin-text);
            font-size: 14px;
        }

        .language-level {
            color: var(--linkedin-text-secondary);
            font-size: 13px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px 24px;
            border-bottom: 1px solid var(--linkedin-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--linkedin-text);
            margin: 0;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--linkedin-text-secondary);
            padding: 0;
            line-height: 1;
        }

        .modal-body {
            padding: 24px;
        }

        .modal-footer {
            padding: 20px 24px;
            border-top: 1px solid var(--linkedin-border);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--linkedin-text);
            font-size: 14px;
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--linkedin-border);
            border-radius: 4px;
            font-size: 14px;
            font-family: 'Inter', sans-serif;
            transition: border-color 0.2s;
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--linkedin-blue);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        /* Edit Mode */
        .section-content {
            transition: all 0.2s;
        }

        .section-content.editing {
            opacity: 0.5;
            pointer-events: none;
        }

        .save-cancel-buttons {
            display: flex;
            gap: 12px;
            margin-top: 20px;
        }

        /* Responsive */
        @media (max-width: 992px) {
            .profile-sections {
                grid-template-columns: 1fr;
            }

            .profile-main {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }

            .profile-details {
                padding-top: 0;
            }

            .profile-stats {
                justify-content: center;
            }

            .profile-actions {
                justify-content: center;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar" style="position: fixed;">
        <div class="navbar-container">
            <a href="/" class="navbar-logo">Smart Career Hub</a>
            <ul class="navbar-menu">
                <li><a href="/" class="navbar-link">Home</a></li>
                <li><a href="#about" class="navbar-link">About</a></li>
                <li><a href="#opportunities" class="navbar-link">opportunities</a></li>
                <li class="user-profile-menu">
                    <div class="profile-dropdown">
                        <button class="profile-button" onclick="toggleDropdown()">
                            <div class="profile-avatar-small">JD</div>
                            <span class="profile-name-nav">John Doe</span>
                            <i class="bi bi-chevron-down"></i>
                        </button>
                        <div class="dropdown-menu" id="profileDropdown">
                            <a href="/chercheur/dashboard" class="dropdown-item">
                                <i class="bi bi-speedometer2"></i>
                                Dashboard
                            </a>
                            <a href="/chercheur/profile" class="dropdown-item">
                                <i class="bi bi-person"></i>
                                My Profile
                            </a>
                            <a href="/chercheur/applications" class="dropdown-item">
                                <i class="bi bi-file-earmark-text"></i>
                                My Applications
                            </a>
                            <a href="/chercheur/saved-jobs" class="dropdown-item">
                                <i class="bi bi-bookmark"></i>
                                Saved Jobs
                            </a>
                            <a href="/chercheur/settings" class="dropdown-item">
                                <i class="bi bi-gear"></i>
                                Settings
                            </a>
                            <div class="dropdown-divider"></div>
                            <a href="/auth/login" class="dropdown-item logout">
                                <i class="bi bi-box-arrow-right"></i>
                                Logout
                            </a>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </nav>

    <div class="dashboard">
        <!-- Sidebar -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <ul style="padding: 0; margin: 0;">
                    <li class="nav-item">
                        <a href="/chercheur/dashboard" class="nav-link">
                            <i class="bi bi-speedometer2"></i>
                            Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/chercheur/jobs" class="nav-link">
                            <i class="bi bi-briefcase"></i>
                            Browse Jobs
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/chercheur/applications" class="nav-link">
                            <i class="bi bi-file-earmark-text"></i>
                            My Applications
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/chercheur/profile" class="nav-link active">
                            <i class="bi bi-person"></i>
                            My Profile
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/chercheur/saved-jobs" class="nav-link">
                            <i class="bi bi-bookmark"></i>
                            Saved Jobs
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/chercheur/messages" class="nav-link">
                            <i class="bi bi-chat-dots"></i>
                            Messages
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/chercheur/settings" class="nav-link">
                            <i class="bi bi-gear"></i>
                            Settings
                        </a>
                    </li>
                </ul>
            </nav>

            <div class="sidebar-footer">
                <a href="/auth/login" class="nav-link" style="margin-top: 1rem; color: #dc2626;">
                    <i class="bi bi-box-arrow-right"></i>
                    Logout
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="profile-container">
                <!-- Profile Header -->
                <div class="profile-header">
                    <div class="cover-photo">
                        <button class="cover-photo-edit" onclick="openModal('coverPhotoModal')">
                            <i class="bi bi-camera"></i>
                            Edit cover photo
                        </button>
                    </div>
                    <div class="profile-info">
                        <div class="profile-main">
                            <div class="profile-avatar-large" id="profileAvatar">
                                <div class="avatar-edit-btn" onclick="openModal('avatarModal')">
                                    <i class="bi bi-camera"></i>
                                </div>
                            </div>
                            <div class="profile-details">
                                <h1 class="profile-name" id="profileName">John Doe</h1>
                                <h2 class="profile-title" id="profileTitle">Senior Software Engineer</h2>
                                <p class="profile-location" id="profileLocation">
                                    <i class="bi bi-geo-alt"></i>
                                    San Francisco, California, United States
                                </p>
                                <div class="profile-stats">
                                    <div class="stat-item">
                                        <span class="stat-number">245</span>
                                        <span>Connections</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number">15</span>
                                        <span>Applications</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number">8</span>
                                        <span>Saved Jobs</span>
                                    </div>
                                </div>
                                <div class="profile-actions">
                                    <button class="btn-profile-primary" onclick="openModal('contactModal')">
                                        <i class="bi bi-envelope"></i>
                                        Contact Info
                                    </button>
                                    <button class="btn-profile-secondary" onclick="openModal('shareProfileModal')">
                                        <i class="bi bi-share"></i>
                                        Share Profile
                                    </button>
                                    <button class="btn-profile-outline" onclick="openModal('exportProfileModal')">
                                        <i class="bi bi-download"></i>
                                        Export as PDF
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Main Content Sections -->
                <div class="profile-sections">
                    <!-- Left Column -->
                    <div class="left-column">
                        <!-- About Section -->
                        <div class="profile-section">
                            <div class="section-header">
                                <h3 class="section-title">About</h3>
                                <button class="edit-section-btn" onclick="editSection('about')">
                                    <i class="bi bi-pencil"></i>
                                    Edit
                                </button>
                            </div>
                            <div class="section-content" id="aboutContent">
                                <p class="about-content">
                                    Passionate software engineer with 5+ years of experience in full-stack development.
                                    Specialized in building scalable web applications using modern technologies.
                                    Strong background in JavaScript, React, Node.js, and cloud technologies.
                                </p>
                            </div>
                            <div class="section-edit-form" id="aboutEditForm" style="display: none;">
                                <textarea class="form-textarea" id="aboutTextarea" rows="6">
Passionate software engineer with 5+ years of experience in full-stack development. 
Specialized in building scalable web applications using modern technologies. 
Strong background in JavaScript, React, Node.js, and cloud technologies.</textarea>
                                <div class="save-cancel-buttons">
                                    <button class="btn-profile-primary" onclick="saveSection('about')">
                                        Save
                                    </button>
                                    <button class="btn-profile-outline" onclick="cancelEdit('about')">
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Experience Section -->
                        <div class="profile-section">
                            <div class="section-header">
                                <h3 class="section-title">Experience</h3>
                                <button class="edit-section-btn" onclick="openModal('experienceModal')">
                                    <i class="bi bi-plus"></i>
                                    Add Experience
                                </button>
                            </div>
                            <div class="experience-list" id="experienceList">
                                <div class="experience-item">
                                    <div class="exp-company">TechCorp Solutions</div>
                                    <div class="exp-position">Senior Software Engineer</div>
                                    <div class="exp-duration">Jan 2022 - Present • 2 years 6 months</div>
                                    <div class="exp-description">
                                        Lead development of cloud-native applications using microservices architecture.
                                        Improved application performance by 40% through optimization techniques.
                                    </div>
                                    <div style="margin-top: 8px;">
                                        <button onclick="editExperience(this)" class="edit-section-btn"
                                            style="font-size: 12px; padding: 4px 8px;">
                                            <i class="bi bi-pencil"></i> Edit
                                        </button>
                                        <button onclick="deleteExperience(this)" class="edit-section-btn"
                                            style="font-size: 12px; padding: 4px 8px; color: #dc2626;">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </div>
                                </div>
                                <div class="experience-item">
                                    <div class="exp-company">Digital Innovations Inc.</div>
                                    <div class="exp-position">Software Engineer</div>
                                    <div class="exp-duration">Jun 2019 - Dec 2021 • 2 years 7 months</div>
                                    <div class="exp-description">
                                        Developed and maintained web applications using React and Node.js.
                                        Collaborated with cross-functional teams to deliver high-quality software.
                                    </div>
                                    <div style="margin-top: 8px;">
                                        <button onclick="editExperience(this)" class="edit-section-btn"
                                            style="font-size: 12px; padding: 4px 8px;">
                                            <i class="bi bi-pencil"></i> Edit
                                        </button>
                                        <button onclick="deleteExperience(this)" class="edit-section-btn"
                                            style="font-size: 12px; padding: 4px 8px; color: #dc2626;">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Education Section -->
                        <div class="profile-section">
                            <div class="section-header">
                                <h3 class="section-title">Education</h3>
                                <button class="edit-section-btn" onclick="openModal('educationModal')">
                                    <i class="bi bi-plus"></i>
                                    Add Education
                                </button>
                            </div>
                            <div class="education-list" id="educationList">
                                <div class="education-item">
                                    <div class="edu-institution">Stanford University</div>
                                    <div class="edu-degree">Master of Science in Computer Science</div>
                                    <div class="edu-duration">2017 - 2019</div>
                                    <div style="margin-top: 8px;">
                                        <button onclick="editEducation(this)" class="edit-section-btn"
                                            style="font-size: 12px; padding: 4px 8px;">
                                            <i class="bi bi-pencil"></i> Edit
                                        </button>
                                        <button onclick="deleteEducation(this)" class="edit-section-btn"
                                            style="font-size: 12px; padding: 4px 8px; color: #dc2626;">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </div>
                                </div>
                                <div class="education-item">
                                    <div class="edu-institution">MIT</div>
                                    <div class="edu-degree">Bachelor of Science in Software Engineering</div>
                                    <div class="edu-duration">2013 - 2017</div>
                                    <div style="margin-top: 8px;">
                                        <button onclick="editEducation(this)" class="edit-section-btn"
                                            style="font-size: 12px; padding: 4px 8px;">
                                            <i class="bi bi-pencil"></i> Edit
                                        </button>
                                        <button onclick="deleteEducation(this)" class="edit-section-btn"
                                            style="font-size: 12px; padding: 4px 8px; color: #dc2626;">
                                            <i class="bi bi-trash"></i> Delete
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Skills Section -->
                        <div class="profile-section">
                            <div class="section-header">
                                <h3 class="section-title">Skills</h3>
                                <button class="edit-section-btn" onclick="openModal('skillsModal')">
                                    <i class="bi bi-plus"></i>
                                    Add Skills
                                </button>
                            </div>
                            <div class="skills-container" id="skillsList">
                                <span class="skill-tag">JavaScript</span>
                                <span class="skill-tag">React</span>
                                <span class="skill-tag">Node.js</span>
                                <span class="skill-tag">Python</span>
                                <span class="skill-tag">AWS</span>
                                <span class="skill-tag">Docker</span>
                                <span class="skill-tag">Kubernetes</span>
                                <span class="skill-tag">TypeScript</span>
                            </div>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="right-column">
                        <!-- Contact Info Widget -->
                        <div class="profile-widget">
                            <h4 class="widget-title">Contact Information</h4>
                            <div class="contact-info" id="contactInfoWidget">
                                <div class="contact-item">
                                    <i class="bi bi-envelope"></i>
                                    <span>john.doe@example.com</span>
                                </div>
                                <div class="contact-item">
                                    <i class="bi bi-phone"></i>
                                    <span>+1 (234) 567-8900</span>
                                </div>
                                <div class="contact-item">
                                    <i class="bi bi-linkedin"></i>
                                    <a href="https://linkedin.com/in/johndoe" style="color: var(--linkedin-blue);"
                                        target="_blank">linkedin.com/in/johndoe</a>
                                </div>
                                <div class="contact-item">
                                    <i class="bi bi-github"></i>
                                    <a href="https://github.com/johndoe" style="color: var(--linkedin-blue);"
                                        target="_blank">github.com/johndoe</a>
                                </div>
                                <div class="contact-item">
                                    <i class="bi bi-globe"></i>
                                    <a href="https://johndoe.com" style="color: var(--linkedin-blue);"
                                        target="_blank">johndoe.com</a>
                                </div>
                            </div>
                        </div>

                        <!-- Languages Widget -->
                        <div class="profile-widget">
                            <h4 class="widget-title">Languages</h4>
                            <div class="languages-list">
                                <div class="language-item">
                                    <span class="language-name">English</span>
                                    <span class="language-level">Native</span>
                                </div>
                                <div class="language-item">
                                    <span class="language-name">Spanish</span>
                                    <span class="language-level">Fluent</span>
                                </div>
                                <div class="language-item">
                                    <span class="language-name">French</span>
                                    <span class="language-level">Intermediate</span>
                                </div>
                            </div>
                        </div>

                        <!-- Resume Widget -->
                        <div class="profile-widget">
                            <h4 class="widget-title">Resume</h4>
                            <div class="resume-info">
                                <div class="contact-item">
                                    <i class="bi bi-file-earmark-pdf"></i>
                                    <div>
                                        <div style="font-weight: 500;">John_Doe_Resume.pdf</div>
                                        <div style="font-size: 12px; color: var(--linkedin-text-secondary);">
                                            245 KB • Updated 2 days ago
                                        </div>
                                    </div>
                                </div>
                                <button class="btn-profile-secondary" style="width: 100%; margin-top: 16px;"
                                    onclick="openModal('resumeModal')">
                                    <i class="bi bi-upload"></i>
                                    Update Resume
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Avatar Modal -->
    <div id="avatarModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Update Profile Photo</h3>
                <button class="modal-close" onclick="closeModal('avatarModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Upload Photo</label>
                    <input type="file" id="avatarUpload" accept="image/*" class="form-input">
                    <p style="font-size: 12px; color: var(--linkedin-text-secondary); margin-top: 8px;">
                        JPG, PNG or GIF. Max size 2MB.
                    </p>
                </div>
                <div class="form-group">
                    <label class="form-label">Or enter image URL</label>
                    <input type="url" id="avatarUrl" class="form-input" placeholder="https://example.com/photo.jpg">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('avatarModal')">Cancel</button>
                <button class="btn-profile-primary" onclick="updateAvatar()">Save</button>
            </div>
        </div>
    </div>

    <!-- Experience Modal -->
    <div id="experienceModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="experienceModalTitle">Add Experience</h3>
                <button class="modal-close" onclick="closeModal('experienceModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Title *</label>
                    <input type="text" id="expTitle" class="form-input" placeholder="e.g. Senior Software Engineer">
                </div>
                <div class="form-group">
                    <label class="form-label">Company *</label>
                    <input type="text" id="expCompany" class="form-input" placeholder="e.g. TechCorp Solutions">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Start Date *</label>
                        <input type="month" id="expStartDate" class="form-input">
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Date</label>
                        <input type="month" id="expEndDate" class="form-input">
                        <label style="display: flex; align-items: center; gap: 8px; margin-top: 8px;">
                            <input type="checkbox" id="currentlyWorking">
                            <span style="font-size: 14px;">I currently work here</span>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-textarea" id="expDescription" rows="4"
                        placeholder="Describe your responsibilities and achievements..."></textarea>
                </div>
                <input type="hidden" id="experienceEditIndex">
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('experienceModal')">Cancel</button>
                <button class="btn-profile-primary" onclick="saveExperience()" id="saveExperienceBtn">Save
                    Experience</button>
            </div>
        </div>
    </div>

    <!-- Education Modal -->
    <div id="educationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="educationModalTitle">Add Education</h3>
                <button class="modal-close" onclick="closeModal('educationModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">School/University *</label>
                    <input type="text" id="eduInstitution" class="form-input" placeholder="e.g. Stanford University">
                </div>
                <div class="form-group">
                    <label class="form-label">Degree *</label>
                    <input type="text" id="eduDegree" class="form-input"
                        placeholder="e.g. Master of Science in Computer Science">
                </div>
                <div class="form-group">
                    <label class="form-label">Field of Study</label>
                    <input type="text" id="eduField" class="form-input" placeholder="e.g. Computer Science">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Start Year *</label>
                        <select id="eduStartYear" class="form-select">
                            <option value="">Select Year</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Year</label>
                        <select id="eduEndYear" class="form-select">
                            <option value="">Select Year</option>
                            <option value="present">Present</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Grade/GPA</label>
                    <input type="text" id="eduGrade" class="form-input" placeholder="e.g. 3.8 GPA">
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea id="eduDescription" class="form-textarea" rows="3"
                        placeholder="Activities, achievements, or additional information..."></textarea>
                </div>
                <input type="hidden" id="educationEditIndex">
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('educationModal')">Cancel</button>
                <button class="btn-profile-primary" onclick="saveEducation()" id="saveEducationBtn">Save
                    Education</button>
            </div>
        </div>
    </div>

    <!-- Skills Modal -->
    <div id="skillsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Add Skills</h3>
                <button class="modal-close" onclick="closeModal('skillsModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Skill Name *</label>
                    <input type="text" id="skillInput" class="form-input"
                        placeholder="e.g. JavaScript, React, Project Management">
                    <p style="font-size: 12px; color: var(--linkedin-text-secondary); margin-top: 8px;">
                        Separate multiple skills with commas
                    </p>
                </div>
                <div class="form-group">
                    <label class="form-label">Current Skills</label>
                    <div class="current-skills" id="currentSkillsDisplay" style="
                        border: 1px solid var(--linkedin-border);
                        border-radius: 4px;
                        padding: 12px;
                        min-height: 100px;
                        display: flex;
                        flex-wrap: wrap;
                        gap: 8px;
                    ">
                        <!-- Skills will be displayed here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('skillsModal')">Cancel</button>
                <button class="btn-profile-primary" onclick="addSkill()">Add Skill</button>
                <button class="btn-profile-primary" onclick="saveAllSkills()">Save All Skills</button>
            </div>
        </div>
    </div>

    <!-- Contact Info Modal -->
    <div id="contactModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Contact Information</h3>
                <button class="modal-close" onclick="closeModal('contactModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Email Address *</label>
                    <input type="email" id="contactEmail" class="form-input" value="john.doe@example.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Phone Number</label>
                    <input type="tel" id="contactPhone" class="form-input" value="+1 (234) 567-8900">
                </div>
                <div class="form-group">
                    <label class="form-label">LinkedIn Profile URL</label>
                    <input type="url" id="contactLinkedIn" class="form-input" value="https://linkedin.com/in/johndoe">
                </div>
                <div class="form-group">
                    <label class="form-label">GitHub Profile URL</label>
                    <input type="url" id="contactGitHub" class="form-input" value="https://github.com/johndoe">
                </div>
                <div class="form-group">
                    <label class="form-label">Portfolio Website</label>
                    <input type="url" id="contactWebsite" class="form-input" value="https://johndoe.com">
                </div>
                <div class="form-group">
                    <label class="form-label">Address</label>
                    <textarea id="contactAddress" class="form-textarea"
                        rows="3">San Francisco, California, United States</textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('contactModal')">Cancel</button>
                <button class="btn-profile-primary" onclick="saveContactInfo()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Resume Modal -->
    <div id="resumeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Update Resume</h3>
                <button class="modal-close" onclick="closeModal('resumeModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Current Resume</label>
                    <div
                        style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--linkedin-gray-bg); border-radius: 4px;">
                        <i class="bi bi-file-earmark-pdf" style="font-size: 24px; color: #dc2626;"></i>
                        <div>
                            <div style="font-weight: 500;">John_Doe_Resume.pdf</div>
                            <div style="font-size: 12px; color: var(--linkedin-text-secondary);">
                                245 KB • Updated 2 days ago
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Upload New Resume</label>
                    <input type="file" id="resumeUpload" accept=".pdf,.doc,.docx" class="form-input">
                    <p style="font-size: 12px; color: var(--linkedin-text-secondary); margin-top: 8px;">
                        PDF, DOC, or DOCX. Max size 5MB.
                    </p>
                </div>
                <div class="form-group">
                    <label class="form-label">Resume Visibility</label>
                    <select class="form-select">
                        <option value="public">Public - Visible to all employers</option>
                        <option value="private">Private - Only visible when you apply</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('resumeModal')">Cancel</button>
                <button class="btn-profile-primary" onclick="updateResume()">Update Resume</button>
            </div>
        </div>
    </div>

    <!-- Cover Photo Modal -->
    <div id="coverPhotoModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Update Cover Photo</h3>
                <button class="modal-close" onclick="closeModal('coverPhotoModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Upload Cover Photo</label>
                    <input type="file" id="coverUpload" accept="image/*" class="form-input">
                    <p style="font-size: 12px; color: var(--linkedin-text-secondary); margin-top: 8px;">
                        JPG or PNG. Recommended size: 1500x500 pixels.
                    </p>
                </div>
                <div class="form-group">
                    <label class="form-label">Cover Photo Templates</label>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 8px;">
                        <div class="cover-template"
                            style="height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 4px; cursor: pointer;"
                            onclick="applyCoverTemplate(this)"></div>
                        <div class="cover-template"
                            style="height: 80px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 4px; cursor: pointer;"
                            onclick="applyCoverTemplate(this)"></div>
                        <div class="cover-template"
                            style="height: 80px; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); border-radius: 4px; cursor: pointer;"
                            onclick="applyCoverTemplate(this)"></div>
                        <div class="cover-template"
                            style="height: 80px; background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); border-radius: 4px; cursor: pointer;"
                            onclick="applyCoverTemplate(this)"></div>
                        <div class="cover-template"
                            style="height: 80px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 4px; cursor: pointer;"
                            onclick="applyCoverTemplate(this)"></div>
                        <div class="cover-template"
                            style="height: 80px; background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); border-radius: 4px; cursor: pointer;"
                            onclick="applyCoverTemplate(this)"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('coverPhotoModal')">Cancel</button>
                <button class="btn-profile-primary" onclick="updateCoverPhoto()">Save Cover Photo</button>
            </div>
        </div>
    </div>

    <!-- Share Profile Modal -->
    <div id="shareProfileModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Share Your Profile</h3>
                <button class="modal-close" onclick="closeModal('shareProfileModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Profile Link</label>
                    <div style="display: flex; gap: 8px;">
                        <input type="text" id="profileLink" class="form-input"
                            value="https://smartcareerhub.com/profile/johndoe" readonly>
                        <button class="btn-profile-primary" onclick="copyProfileLink()" style="white-space: nowrap;">
                            <i class="bi bi-clipboard"></i> Copy
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Share via</label>
                    <div style="display: flex; gap: 12px; margin-top: 8px;">
                        <button class="btn-profile-outline" onclick="shareOnLinkedIn()" style="flex: 1;">
                            <i class="bi bi-linkedin"></i> LinkedIn
                        </button>
                        <button class="btn-profile-outline" onclick="shareOnTwitter()" style="flex: 1;">
                            <i class="bi bi-twitter"></i> Twitter
                        </button>
                        <button class="btn-profile-outline" onclick="shareViaEmail()" style="flex: 1;">
                            <i class="bi bi-envelope"></i> Email
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Share with QR Code</label>
                    <div
                        style="text-align: center; padding: 20px; background: var(--linkedin-gray-bg); border-radius: 4px;">
                        <div id="qrCodePlaceholder"
                            style="width: 150px; height: 150px; margin: 0 auto; background: #f0f0f0; display: flex; align-items: center; justify-content: center; color: var(--linkedin-text-secondary);">
                            QR Code Preview
                        </div>
                        <button class="btn-profile-outline" onclick="downloadQRCode()" style="margin-top: 12px;">
                            <i class="bi bi-download"></i> Download QR Code
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('shareProfileModal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Export Profile Modal -->
    <div id="exportProfileModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Export Profile</h3>
                <button class="modal-close" onclick="closeModal('exportProfileModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Export Format</label>
                    <div style="display: flex; gap: 12px;">
                        <label
                            style="flex: 1; border: 2px solid var(--linkedin-border); border-radius: 8px; padding: 16px; text-align: center; cursor: pointer;">
                            <input type="radio" name="exportFormat" value="pdf" checked style="display: none;">
                            <i class="bi bi-file-earmark-pdf"
                                style="font-size: 32px; color: #dc2626; display: block; margin-bottom: 8px;"></i>
                            <div style="font-weight: 600;">PDF</div>
                            <div style="font-size: 12px; color: var(--linkedin-text-secondary);">Standard format</div>
                        </label>
                        <label
                            style="flex: 1; border: 2px solid var(--linkedin-border); border-radius: 8px; padding: 16px; text-align: center; cursor: pointer;">
                            <input type="radio" name="exportFormat" value="doc" style="display: none;">
                            <i class="bi bi-file-earmark-word"
                                style="font-size: 32px; color: #2b579a; display: block; margin-bottom: 8px;"></i>
                            <div style="font-weight: 600;">Word</div>
                            <div style="font-size: 12px; color: var(--linkedin-text-secondary);">Editable format</div>
                        </label>
                        <label
                            style="flex: 1; border: 2px solid var(--linkedin-border); border-radius: 8px; padding: 16px; text-align: center; cursor: pointer;">
                            <input type="radio" name="exportFormat" value="json" style="display: none;">
                            <i class="bi bi-code-slash"
                                style="font-size: 32px; color: #3c873a; display: block; margin-bottom: 8px;"></i>
                            <div style="font-weight: 600;">JSON</div>
                            <div style="font-size: 12px; color: var(--linkedin-text-secondary);">Data format</div>
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Include Sections</label>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px;">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" checked> Personal Info
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" checked> Experience
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" checked> Education
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" checked> Skills
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox"> Contact Info
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" checked> Resume
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">File Name</label>
                    <input type="text" class="form-input" value="John_Doe_Profile">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-profile-outline" onclick="closeModal('exportProfileModal')">Cancel</button>
                <button class="btn-profile-primary" onclick="exportProfile()">
                    <i class="bi bi-download"></i> Export Profile
                </button>
            </div>
        </div>
    </div>

    <script>
        // ==================== INITIALIZATION ====================
        document.addEventListener('DOMContentLoaded', function () {
            // Populate year dropdowns
            populateYearDropdowns();

            // Load saved data from localStorage
            loadSavedData();

            // Initialize skills display
            updateSkillsDisplay();

            // Initialize avatar from localStorage
            const savedAvatar = localStorage.getItem('profileAvatar');
            if (savedAvatar) {
                const avatar = document.getElementById('profileAvatar');
                avatar.style.backgroundImage = `url(${savedAvatar})`;
                avatar.innerHTML = '<div class="avatar-edit-btn" onclick="openModal(\'avatarModal\')"><i class="bi bi-camera"></i></div>';
            }
        });

        // ==================== MODAL FUNCTIONS ====================
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
            document.body.style.overflow = 'auto';

            // Reset form if it's an experience modal
            if (modalId === 'experienceModal') {
                resetExperienceForm();
            }
            if (modalId === 'educationModal') {
                resetEducationForm();
            }
        }

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (e.target === modal) {
                    modal.classList.remove('show');
                    document.body.style.overflow = 'auto';
                }
            });
        });

        // ==================== PROFILE SECTION EDITING ====================
        function editSection(sectionId) {
            const content = document.getElementById(sectionId + 'Content');
            const editForm = document.getElementById(sectionId + 'EditForm');

            content.classList.add('editing');
            content.style.display = 'none';
            editForm.style.display = 'block';
        }

        function saveSection(sectionId) {
            const content = document.getElementById(sectionId + 'Content');
            const editForm = document.getElementById(sectionId + 'EditForm');
            const textarea = document.getElementById(sectionId + 'Textarea');

            if (sectionId === 'about') {
                content.querySelector('.about-content').textContent = textarea.value;
                localStorage.setItem('aboutContent', textarea.value);
            }

            content.classList.remove('editing');
            content.style.display = 'block';
            editForm.style.display = 'none';

            showToast('Section updated successfully!');
            saveToLocalStorage();
        }

        function cancelEdit(sectionId) {
            const content = document.getElementById(sectionId + 'Content');
            const editForm = document.getElementById(sectionId + 'EditForm');

            content.classList.remove('editing');
            content.style.display = 'block';
            editForm.style.display = 'none';
        }

        // ==================== EXPERIENCE MANAGEMENT ====================
        function openExperienceModalForEdit(index) {
            const experiences = document.querySelectorAll('.experience-item');
            if (index < experiences.length) {
                const exp = experiences[index];
                const company = exp.querySelector('.exp-company').textContent;
                const position = exp.querySelector('.exp-position').textContent;
                const description = exp.querySelector('.exp-description')?.textContent || '';

                document.getElementById('expTitle').value = position;
                document.getElementById('expCompany').value = company;
                document.getElementById('expDescription').value = description;
                document.getElementById('experienceEditIndex').value = index;
                document.getElementById('experienceModalTitle').textContent = 'Edit Experience';
                document.getElementById('saveExperienceBtn').textContent = 'Update Experience';

                openModal('experienceModal');
            }
        }

        function saveExperience() {
            const title = document.getElementById('expTitle').value;
            const company = document.getElementById('expCompany').value;
            const startDate = document.getElementById('expStartDate').value;
            const endDate = document.getElementById('expEndDate').value;
            const description = document.getElementById('expDescription').value;
            const currentlyWorking = document.getElementById('currentlyWorking').checked;
            const editIndex = document.getElementById('experienceEditIndex').value;

            if (!title || !company || !startDate) {
                showToast('Please fill in required fields', 'error');
                return;
            }

            if (editIndex !== '') {
                // Update existing experience
                updateExistingExperience(editIndex, { title, company, startDate, endDate, description, currentlyWorking });
            } else {
                // Add new experience
                addNewExperience({ title, company, startDate, endDate, description, currentlyWorking });
            }

            closeModal('experienceModal');
        }

        function addNewExperience(data) {
            const experienceList = document.getElementById('experienceList');
            const newItem = document.createElement('div');
            newItem.className = 'experience-item';

            // Format dates
            const startDate = new Date(data.startDate + '-01');
            const startFormatted = startDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });

            let durationText = startFormatted;
            let durationCalculation = '';

            if (data.currentlyWorking) {
                durationText += ' - Present';
            } else if (data.endDate) {
                const endDate = new Date(data.endDate + '-01');
                const endFormatted = endDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
                durationText += ' - ' + endFormatted;

                // Calculate duration
                const months = (endDate.getFullYear() - startDate.getFullYear()) * 12 +
                    (endDate.getMonth() - startDate.getMonth());
                const years = Math.floor(months / 12);
                const remainingMonths = months % 12;

                if (years > 0) durationCalculation += `${years} year${years > 1 ? 's' : ''}`;
                if (remainingMonths > 0) {
                    if (years > 0) durationCalculation += ' ';
                    durationCalculation += `${remainingMonths} month${remainingMonths > 1 ? 's' : ''}`;
                }
            }

            if (durationCalculation) {
                durationText += ` • ${durationCalculation}`;
            }

            newItem.innerHTML = `
                <div class="exp-company">${data.company}</div>
                <div class="exp-position">${data.title}</div>
                <div class="exp-duration">${durationText}</div>
                ${data.description ? `<div class="exp-description">${data.description}</div>` : ''}
                <div style="margin-top: 8px;">
                    <button onclick="openExperienceModalForEdit(${document.querySelectorAll('.experience-item').length})" class="edit-section-btn" style="font-size: 12px; padding: 4px 8px;">
                        <i class="bi bi-pencil"></i> Edit
                    </button>
                    <button onclick="deleteExperience(this)" class="edit-section-btn" style="font-size: 12px; padding: 4px 8px; color: #dc2626;">
                        <i class="bi bi-trash"></i> Delete
                    </button>
                </div>
            `;

            experienceList.prepend(newItem);
            showToast('Experience added successfully!');
        }

        function updateExistingExperience(index, data) {
            const experiences = document.querySelectorAll('.experience-item');
            if (index < experiences.length) {
                const exp = experiences[index];
                exp.querySelector('.exp-company').textContent = data.company;
                exp.querySelector('.exp-position').textContent = data.title;

                // Format dates
                const startDate = new Date(data.startDate + '-01');
                const startFormatted = startDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });

                let durationText = startFormatted;
                if (data.currentlyWorking) {
                    durationText += ' - Present';
                } else if (data.endDate) {
                    const endDate = new Date(data.endDate + '-01');
                    const endFormatted = endDate.toLocaleDateString('en-US', { month: 'short', year: 'numeric' });
                    durationText += ' - ' + endFormatted;
                }

                exp.querySelector('.exp-duration').textContent = durationText;

                if (data.description) {
                    let descElement = exp.querySelector('.exp-description');
                    if (!descElement) {
                        descElement = document.createElement('div');
                        descElement.className = 'exp-description';
                        exp.appendChild(descElement);
                    }
                    descElement.textContent = data.description;
                }

                showToast('Experience updated successfully!');
            }
        }

        function editExperience(button) {
            const item = button.closest('.experience-item');
            const items = Array.from(document.querySelectorAll('.experience-item'));
            const index = items.indexOf(item);
            openExperienceModalForEdit(index);
        }

        function deleteExperience(button) {
            if (confirm('Are you sure you want to delete this experience?')) {
                const item = button.closest('.experience-item');
                item.remove();
                showToast('Experience deleted');
                saveToLocalStorage();
            }
        }

        function resetExperienceForm() {
            document.getElementById('expTitle').value = '';
            document.getElementById('expCompany').value = '';
            document.getElementById('expStartDate').value = '';
            document.getElementById('expEndDate').value = '';
            document.getElementById('expDescription').value = '';
            document.getElementById('currentlyWorking').checked = false;
            document.getElementById('experienceEditIndex').value = '';
            document.getElementById('experienceModalTitle').textContent = 'Add Experience';
            document.getElementById('saveExperienceBtn').textContent = 'Save Experience';
        }

        // ==================== EDUCATION MANAGEMENT ====================
        function populateYearDropdowns() {
            const currentYear = new Date().getFullYear();
            const startYear = currentYear - 50;

            const startSelect = document.getElementById('eduStartYear');
            const endSelect = document.getElementById('eduEndYear');

            // Clear existing options
            startSelect.innerHTML = '<option value="">Select Year</option>';
            endSelect.innerHTML = '<option value="">Select Year</option><option value="present">Present</option>';

            // Add years
            for (let year = currentYear; year >= startYear; year--) {
                const option1 = document.createElement('option');
                option1.value = year;
                option1.textContent = year;
                startSelect.appendChild(option1);

                const option2 = document.createElement('option');
                option2.value = year;
                option2.textContent = year;
                endSelect.appendChild(option2);
            }
        }

        function saveEducation() {
            const institution = document.getElementById('eduInstitution').value;
            const degree = document.getElementById('eduDegree').value;
            const field = document.getElementById('eduField').value;
            const startYear = document.getElementById('eduStartYear').value;
            const endYear = document.getElementById('eduEndYear').value;
            const grade = document.getElementById('eduGrade').value;
            const description = document.getElementById('eduDescription').value;
            const editIndex = document.getElementById('educationEditIndex').value;

            if (!institution || !degree || !startYear) {
                showToast('Please fill in required fields', 'error');
                return;
            }

            if (editIndex !== '') {
                // Update existing education
                updateExistingEducation(editIndex, { institution, degree, field, startYear, endYear, grade, description });
            } else {
                // Add new education
                addNewEducation({ institution, degree, field, startYear, endYear, grade, description });
            }

            closeModal('educationModal');
        }

        function addNewEducation(data) {
            const educationList = document.getElementById('educationList');
            const newItem = document.createElement('div');
            newItem.className = 'education-item';

            // Format duration
            let durationText = data.startYear;
            if (data.endYear === 'present') {
                durationText += ' - Present';
            } else if (data.endYear) {
                durationText += ' - ' + data.endYear;
            }

            // Add grade if provided
            let gradeText = '';
            if (data.grade) {
                gradeText = ` • ${data.grade}`;
            }

            newItem.innerHTML = `
                <div class="edu-institution">${data.institution}</div>
                <div class="edu-degree">${data.degree}${data.field ? ` in ${data.field}` : ''}</div>
                <div class="edu-duration">${durationText}${gradeText}</div>
                ${data.description ? `<div class="exp-description" style="margin-top: 8px;">${data.description}</div>` : ''}
                <div style="margin-top: 8px;">
                    <button onclick="openEducationModalForEdit(${document.querySelectorAll('.education-item').length})" class="edit-section-btn" style="font-size: 12px; padding: 4px 8px;">
                        <i class="bi bi-pencil"></i> Edit
                    </button>
                    <button onclick="deleteEducation(this)" class="edit-section-btn" style="font-size: 12px; padding: 4px 8px; color: #dc2626;">
                        <i class="bi bi-trash"></i> Delete
                    </button>
                </div>
            `;

            educationList.prepend(newItem);
            showToast('Education added successfully!');
        }

        function updateExistingEducation(index, data) {
            const educations = document.querySelectorAll('.education-item');
            if (index < educations.length) {
                const edu = educations[index];
                edu.querySelector('.edu-institution').textContent = data.institution;
                edu.querySelector('.edu-degree').textContent = data.degree + (data.field ? ` in ${data.field}` : '');

                let durationText = data.startYear;
                if (data.endYear === 'present') {
                    durationText += ' - Present';
                } else if (data.endYear) {
                    durationText += ' - ' + data.endYear;
                }

                if (data.grade) {
                    durationText += ` • ${data.grade}`;
                }

                edu.querySelector('.edu-duration').textContent = durationText;

                if (data.description) {
                    let descElement = edu.querySelector('.exp-description');
                    if (!descElement) {
                        descElement = document.createElement('div');
                        descElement.className = 'exp-description';
                        descElement.style.marginTop = '8px';
                        edu.appendChild(descElement);
                    }
                    descElement.textContent = data.description;
                }

                showToast('Education updated successfully!');
            }
        }

        function openEducationModalForEdit(index) {
            const educations = document.querySelectorAll('.education-item');
            if (index < educations.length) {
                const edu = educations[index];
                const institution = edu.querySelector('.edu-institution').textContent;
                const degree = edu.querySelector('.edu-degree').textContent;
                const duration = edu.querySelector('.edu-duration').textContent;
                const description = edu.querySelector('.exp-description')?.textContent || '';

                // Parse duration
                const durationParts = duration.split(' - ');
                const startYear = durationParts[0];
                let endYear = durationParts[1]?.split(' •')[0];
                if (endYear === 'Present') endYear = 'present';

                // Parse grade
                let grade = '';
                const gradeMatch = duration.match(/• (.+)/);
                if (gradeMatch) grade = gradeMatch[1];

                document.getElementById('eduInstitution').value = institution;
                document.getElementById('eduDegree').value = degree.split(' in ')[0];
                document.getElementById('eduField').value = degree.split(' in ')[1] || '';
                document.getElementById('eduStartYear').value = startYear;
                document.getElementById('eduEndYear').value = endYear || '';
                document.getElementById('eduGrade').value = grade;
                document.getElementById('eduDescription').value = description;
                document.getElementById('educationEditIndex').value = index;
                document.getElementById('educationModalTitle').textContent = 'Edit Education';
                document.getElementById('saveEducationBtn').textContent = 'Update Education';

                openModal('educationModal');
            }
        }

        function editEducation(button) {
            const item = button.closest('.education-item');
            const items = Array.from(document.querySelectorAll('.education-item'));
            const index = items.indexOf(item);
            openEducationModalForEdit(index);
        }

        function deleteEducation(button) {
            if (confirm('Are you sure you want to delete this education?')) {
                const item = button.closest('.education-item');
                item.remove();
                showToast('Education deleted');
                saveToLocalStorage();
            }
        }

        function resetEducationForm() {
            document.getElementById('eduInstitution').value = '';
            document.getElementById('eduDegree').value = '';
            document.getElementById('eduField').value = '';
            document.getElementById('eduStartYear').value = '';
            document.getElementById('eduEndYear').value = '';
            document.getElementById('eduGrade').value = '';
            document.getElementById('eduDescription').value = '';
            document.getElementById('educationEditIndex').value = '';
            document.getElementById('educationModalTitle').textContent = 'Add Education';
            document.getElementById('saveEducationBtn').textContent = 'Save Education';
        }

        // ==================== SKILLS MANAGEMENT ====================
        let userSkills = ['JavaScript', 'React', 'Node.js', 'Python', 'AWS', 'Docker', 'Kubernetes', 'TypeScript'];

        function updateSkillsDisplay() {
            const skillsDisplay = document.getElementById('currentSkillsDisplay');
            const mainSkillsList = document.getElementById('skillsList');

            // Update modal display
            skillsDisplay.innerHTML = '';
            userSkills.forEach((skill, index) => {
                const skillElement = document.createElement('div');
                skillElement.className = 'skill-tag';
                skillElement.style.display = 'flex';
                skillElement.style.alignItems = 'center';
                skillElement.style.gap = '8px';

                skillElement.innerHTML = `
                    ${skill}
                    <button onclick="removeSkill(${index})" style="
                        background: none;
                        border: none;
                        color: #666;
                        cursor: pointer;
                        font-size: 12px;
                        padding: 0;
                        line-height: 1;
                    ">
                        <i class="bi bi-x"></i>
                    </button>
                `;

                skillsDisplay.appendChild(skillElement);
            });

            // Update main display
            mainSkillsList.innerHTML = '';
            userSkills.forEach(skill => {
                const skillTag = document.createElement('span');
                skillTag.className = 'skill-tag';
                skillTag.textContent = skill;
                mainSkillsList.appendChild(skillTag);
            });
        }

        function addSkill() {
            const skillInput = document.getElementById('skillInput');

            if (!skillInput.value.trim()) {
                showToast('Please enter a skill name', 'error');
                return;
            }

            // Split by commas and trim each skill
            const newSkills = skillInput.value.split(',')
                .map(skill => skill.trim())
                .filter(skill => skill.length > 0);

            // Add new skills to the array
            newSkills.forEach(skill => {
                if (!userSkills.includes(skill)) {
                    userSkills.push(skill);
                }
            });

            // Update displays
            updateSkillsDisplay();

            // Clear input
            skillInput.value = '';

            showToast('Skills added successfully!');
        }

        function removeSkill(index) {
            userSkills.splice(index, 1);
            updateSkillsDisplay();
            showToast('Skill removed');
        }

        function saveAllSkills() {
            localStorage.setItem('userSkills', JSON.stringify(userSkills));
            showToast('Skills saved successfully!');
            closeModal('skillsModal');
        }

        // ==================== CONTACT INFO MANAGEMENT ====================
        function saveContactInfo() {
            const email = document.getElementById('contactEmail').value;
            const phone = document.getElementById('contactPhone').value;
            const linkedin = document.getElementById('contactLinkedIn').value;
            const github = document.getElementById('contactGitHub').value;
            const website = document.getElementById('contactWebsite').value;
            const address = document.getElementById('contactAddress').value;

            if (!email) {
                showToast('Email address is required', 'error');
                return;
            }

            // Update profile location
            document.getElementById('profileLocation').innerHTML = `
                <i class="bi bi-geo-alt"></i>
                ${address}
            `;

            // Update contact widget
            const contactWidget = document.getElementById('contactInfoWidget');
            contactWidget.innerHTML = `
                <div class="contact-item">
                    <i class="bi bi-envelope"></i>
                    <span>${email}</span>
                </div>
                <div class="contact-item">
                    <i class="bi bi-phone"></i>
                    <span>${phone}</span>
                </div>
                <div class="contact-item">
                    <i class="bi bi-linkedin"></i>
                    <a href="${linkedin}" style="color: var(--linkedin-blue);" target="_blank">${linkedin.replace('https://', '')}</a>
                </div>
                <div class="contact-item">
                    <i class="bi bi-github"></i>
                    <a href="${github}" style="color: var(--linkedin-blue);" target="_blank">${github.replace('https://', '')}</a>
                </div>
                <div class="contact-item">
                    <i class="bi bi-globe"></i>
                    <a href="${website}" style="color: var(--linkedin-blue);" target="_blank">${website.replace('https://', '')}</a>
                </div>
            `;

            // Save to localStorage
            localStorage.setItem('contactEmail', email);
            localStorage.setItem('contactPhone', phone);
            localStorage.setItem('contactLinkedIn', linkedin);
            localStorage.setItem('contactGitHub', github);
            localStorage.setItem('contactWebsite', website);
            localStorage.setItem('contactAddress', address);

            closeModal('contactModal');
            showToast('Contact information updated!');
        }

        // ==================== AVATAR MANAGEMENT ====================
        function updateAvatar() {
            const fileInput = document.getElementById('avatarUpload');
            const file = fileInput.files[0];
            const urlInput = document.getElementById('avatarUrl').value;

            if (file) {
                // Check file size (max 2MB)
                if (file.size > 2 * 1024 * 1024) {
                    showToast('File size should be less than 2MB', 'error');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function (e) {
                    const avatar = document.getElementById('profileAvatar');
                    avatar.style.backgroundImage = `url(${e.target.result})`;
                    avatar.innerHTML = '<div class="avatar-edit-btn" onclick="openModal(\'avatarModal\')"><i class="bi bi-camera"></i></div>';

                    // Save to localStorage
                    localStorage.setItem('profileAvatar', e.target.result);
                };
                reader.readAsDataURL(file);
            } else if (urlInput) {
                const avatar = document.getElementById('profileAvatar');
                avatar.style.backgroundImage = `url(${urlInput})`;
                avatar.innerHTML = '<div class="avatar-edit-btn" onclick="openModal(\'avatarModal\')"><i class="bi bi-camera"></i></div>';

                // Save URL to localStorage
                localStorage.setItem('profileAvatar', urlInput);
            } else {
                showToast('Please select a file or enter a URL', 'error');
                return;
            }

            closeModal('avatarModal');
            showToast('Profile photo updated!');
        }

        // ==================== COVER PHOTO MANAGEMENT ====================
        function applyCoverTemplate(template) {
            const style = window.getComputedStyle(template);
            const background = style.backgroundImage;
            document.querySelector('.cover-photo').style.backgroundImage = background;
        }

        function updateCoverPhoto() {
            const fileInput = document.getElementById('coverUpload');
            const file = fileInput.files[0];

            if (file) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    document.querySelector('.cover-photo').style.backgroundImage = `url(${e.target.result})`;
                    localStorage.setItem('coverPhoto', e.target.result);
                };
                reader.readAsDataURL(file);
            }

            closeModal('coverPhotoModal');
            showToast('Cover photo updated!');
        }

        // ==================== RESUME MANAGEMENT ====================
        function updateResume() {
            const fileInput = document.getElementById('resumeUpload');
            const file = fileInput.files[0];

            if (file) {
                // Check file size (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showToast('File size should be less than 5MB', 'error');
                    return;
                }

                // Check file type
                const validTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
                if (!validTypes.includes(file.type)) {
                    showToast('Please upload PDF, DOC, or DOCX files only', 'error');
                    return;
                }

                showToast('Resume uploaded successfully!');
                closeModal('resumeModal');
            } else {
                showToast('Please select a file to upload', 'error');
            }
        }

        // ==================== SHARE PROFILE ====================
        function copyProfileLink() {
            const linkInput = document.getElementById('profileLink');
            linkInput.select();
            linkInput.setSelectionRange(0, 99999); // For mobile devices

            navigator.clipboard.writeText(linkInput.value)
                .then(() => showToast('Profile link copied to clipboard!'))
                .catch(err => {
                    // Fallback for older browsers
                    document.execCommand('copy');
                    showToast('Profile link copied to clipboard!');
                });
        }

        function shareOnLinkedIn() {
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent('Check out my professional profile');
            const linkedinUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
            window.open(linkedinUrl, '_blank');
        }

        function shareOnTwitter() {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent('Check out my professional profile on Smart Career Hub');
            const twitterUrl = `https://twitter.com/intent/tweet?url=${url}&text=${text}`;
            window.open(twitterUrl, '_blank');
        }

        function shareViaEmail() {
            const url = window.location.href;
            const subject = encodeURIComponent('My Professional Profile');
            const body = encodeURIComponent(`Check out my professional profile: ${url}`);
            window.location.href = `mailto:?subject=${subject}&body=${body}`;
        }

        function downloadQRCode() {
            showToast('QR Code download feature coming soon!', 'info');
        }

        // ==================== EXPORT PROFILE ====================
        function exportProfile() {
            const format = document.querySelector('input[name="exportFormat"]:checked').value;
            let message = 'Profile exported as ';

            switch (format) {
                case 'pdf':
                    message += 'PDF file';
                    break;
                case 'doc':
                    message += 'Word document';
                    break;
                case 'json':
                    message += 'JSON file';
                    break;
            }

            showToast(message);
            closeModal('exportProfileModal');

            // Simulate download
            setTimeout(() => {
                const link = document.createElement('a');
                link.href = 'javascript:void(0)';
                link.download = `John_Doe_Profile.${format}`;
                link.click();
            }, 1000);
        }

        // ==================== LOCAL STORAGE MANAGEMENT ====================
        function loadSavedData() {
            // Load about content
            const savedAbout = localStorage.getItem('aboutContent');
            if (savedAbout) {
                document.querySelector('.about-content').textContent = savedAbout;
                document.getElementById('aboutTextarea').value = savedAbout;
            }

            // Load contact info
            const savedEmail = localStorage.getItem('contactEmail');
            const savedPhone = localStorage.getItem('contactPhone');
            const savedLinkedIn = localStorage.getItem('contactLinkedIn');
            const savedGitHub = localStorage.getItem('contactGitHub');
            const savedWebsite = localStorage.getItem('contactWebsite');
            const savedAddress = localStorage.getItem('contactAddress');

            if (savedEmail) {
                document.getElementById('contactEmail').value = savedEmail;
                document.getElementById('contactPhone').value = savedPhone || '';
                document.getElementById('contactLinkedIn').value = savedLinkedIn || '';
                document.getElementById('contactGitHub').value = savedGitHub || '';
                document.getElementById('contactWebsite').value = savedWebsite || '';
                document.getElementById('contactAddress').value = savedAddress || '';

                // Update contact widget
                if (savedAddress) {
                    document.getElementById('profileLocation').innerHTML = `
                        <i class="bi bi-geo-alt"></i>
                        ${savedAddress}
                    `;
                }
            }

            // Load skills
            const savedSkills = localStorage.getItem('userSkills');
            if (savedSkills) {
                userSkills = JSON.parse(savedSkills);
                updateSkillsDisplay();
            }

            // Load cover photo
            const savedCover = localStorage.getItem('coverPhoto');
            if (savedCover) {
                document.querySelector('.cover-photo').style.backgroundImage = `url(${savedCover})`;
            }
        }

        function saveToLocalStorage() {
            // Save skills
            localStorage.setItem('userSkills', JSON.stringify(userSkills));

            // Save name and title
            const name = document.getElementById('profileName').textContent;
            const title = document.getElementById('profileTitle').textContent;
            localStorage.setItem('profileName', name);
            localStorage.setItem('profileTitle', title);
        }

        // ==================== TOAST NOTIFICATIONS ====================
        function showToast(message, type = 'success') {
            const toast = document.createElement('div');

            // Set background color based on type
            let backgroundColor = 'var(--linkedin-blue)';
            if (type === 'error') backgroundColor = '#dc2626';
            if (type === 'warning') backgroundColor = '#d97706';
            if (type === 'info') backgroundColor = '#0ea5e9';

            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${backgroundColor};
                color: white;
                padding: 12px 24px;
                border-radius: 4px;
                z-index: 1001;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                animation: slideIn 0.3s ease;
                display: flex;
                align-items: center;
                gap: 8px;
            `;

            // Add icon based on type
            let icon = 'bi-check-circle';
            if (type === 'error') icon = 'bi-exclamation-circle';
            if (type === 'warning') icon = 'bi-exclamation-triangle';
            if (type === 'info') icon = 'bi-info-circle';

            toast.innerHTML = `
                <i class="bi ${icon}"></i>
                <span>${message}</span>
            `;

            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Add CSS animations for toast
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // ==================== NAVBAR FUNCTIONS ====================
        function toggleDropdown() {
            const dropdown = document.getElementById('profileDropdown');
            dropdown.classList.toggle('show');
        }

        window.onclick = function (event) {
            if (!event.target.matches('.profile-button') && !event.target.closest('.profile-button')) {
                const dropdown = document.getElementById('profileDropdown');
                if (dropdown && dropdown.classList.contains('show')) {
                    dropdown.classList.remove('show');
                }
            }
        }
    </script>
</body>

</html>